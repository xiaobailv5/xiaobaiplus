<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lv.xiaobaiplus.dao.base.ImportDataDao">
    <delete id="delWorkloadCheckById"  >
        DELETE FROM checklist WHERE workloadId = #{workloadId};
    </delete>
    <delete id="delWorkloadById"  >
        DELETE FROM workload WHERE work_dataId = #{workloadId};
    </delete>

    <update id="updateWorkBaseload">
        update work_data_base
        <set>
            staffNum = #{staffNum},
            staffName = #{staffName},
            workTime = #{workTime},
            avgHours = #{avgHours},
            remark = #{remark},
            workHours = #{workHours},
            updataTime = #{updataTime}
        </set>
        where `work_dataId` =#{workloadId};
    </update>

    <insert id="insertWorkload" parameterType="java.util.List" useGeneratedKeys="false" >
        INSERT INTO workload (`workloadId`, `work_dataId`, `period`, `overTime`, `workTime`, `username`, `updateTime`, `workCont`, `remark`)
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
            (#{item.workloadId},
            #{item.work_dataId},
            #{item.period},
            #{item.overTime},
            #{item.workTime},
            #{item.username},
            #{item.updateTime},
            #{item.workCont},
            #{item.remark})
        </foreach>
    </insert>
    <insert id="insertChecks" parameterType="java.util.List" useGeneratedKeys="false">
        INSERT INTO checklist
        ( checkId,workloadId,period,username,checkCont,remark)
        values
        <foreach collection="list" item="item" index="index" separator=",">
            (
            #{item.checkId},
            #{item.workloadId},
            #{item.period},
            #{item.username},
            #{item.checkCont},
            #{item.remark}
            )
        </foreach>
    </insert>
    <select id="checkWorks"  resultType="map">
        SELECT period,username,checkCont,remark FROM `checklist` WHERE  checkCont LIKE CONCAT('%',#{checkCont},'%')  and workloadId != #{workloadId}
    </select>



</mapper>